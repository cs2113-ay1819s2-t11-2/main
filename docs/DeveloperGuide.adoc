= Developer Guide
:site-section: DeveloperGuide
:toc:
:toc-title:
:imagesDir: images
:stylesDir: stylesheets
:experimental:

== Setting up

=== Prerequisites

* JDK 9 or later
* IntelliJ IDE

=== Importing the project into IntelliJ

. Open IntelliJ (if you are not in the welcome screen, click `File` > `Close Project` to close the existing project dialog first)
. Set up the correct JDK version
.. Click `Configure` > `Project Defaults` > `Project Structure`
.. If JDK 9 is listed in the drop down, select it. If it is not, click `New...` and select the directory where you installed JDK 9
.. Click `OK`
. Click `Import Project`
. Locate the `build.gradle` file and select it. Click `OK`
. Click `Open as Project`
. Click `OK` to accept the default settings
. Run the `seedu.addressbook.Main` class (right-click the `Main` class and click `Run Main.main()`) and try executing a few commands
. Run all the tests (right-click the `test` folder, and click `Run 'All Tests'`) and ensure that they pass
. Open the `StorageFile` file and check for any code errors
.. Due to an ongoing https://youtrack.jetbrains.com/issue/IDEA-189060[issue] with some of the newer versions of IntelliJ, code errors may be detected even if the project can be built and run successfully
.. To resolve this, place your cursor over any of the code section highlighted in red. Press kbd:[ALT + ENTER], and select `Add '--add-modules=java.xml.bind' to module compiler options`

== Design

image::mainClassDiagram.png[]

== Testing

* In IntelliJ, right-click on the `test` folder and choose `Run 'All Tests'`

[appendix]
== User Stories

Priorities: High (must have) - `* * \*`, Medium (nice to have) - `* \*`, Low (unlikely to have) - `*`

[width="100%",cols="22%,<23%,<25%,<30%",options="header",]
|===========================================================================================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* * *` |new user |see usage instructions |refer to instructions when I forget how to use the App
|`* * *` |user |add a new person |
|`* * *` |user |delete a person |remove entries that I no longer need
|`* * *` |user |find a person by name |locate details of persons without having to go through the entire list
|`* *` |user |hide <<private-contact-detail, private contact details>> by default |minimize chance of someone else seeing them by accident
|`*` |user with many persons in the address book |sort persons by name |locate a person easily
|===========================================================================================================================================

[appendix]
== Use Cases

(For all use cases below, the *System* is the `AddressBook` and the *Actor* is the `user`, unless specified otherwise)

=== Use case: Delete person

*MSS*

. User requests to list persons
. AddressBook shows a list of persons
. User requests to delete a specific person in the list
. AddressBook deletes the person.
+
Use case ends.

*Extensions*

* 2a. The list is empty.
+
Use case ends.

* 3a. The given index is invalid.
** 3a1. AddressBook shows an error message.
+
Use case resumes at step 2.

=== Login/Register/Logout Feature 
==== Current Implementation
The login / register mechanism is facilitated by `AccountManager`, it implements the following operations:

* `AccountManager()` -- The constructor for the class `AccountManager`.
* `loadAccounts` -- Loads all the account information from local storage.
* `storeAccounts` -- Stores all the account information to local storage.
* `getLoginStatus()` -- Returns the login status to the caller.
* `setLoginStatus(boolean)` -- Sets the login status according to the parameter.
* `accountCommandHandler(String)` -- Handles the user input, checks if there is a match for username and password match if the user's command is `login`, trys to regster a new account if the user's command is `register`, returns a string to indicate the outcome.
* `register(String, String)` -- Creates a new account for user.
* `logout` --  Logs the user out of the system


Given below is an example usage scenario and how the login/register/logout mechanism behaves at each step.

Step 1. The user launches the application. The `AccountManager` will be initialized, `loadAccounts` will be called to load all the accounts to a `HashMap` from local storage, the `HashMap` is used to keep track of all the account information.

Step2. The user executes `register Doe 123` command to register a new account with username Doe and password 123. The new username and the corresponding password will be temporarily put into the `HashMap`.

Step3. The user executes `login Doe 123` command to login to the system, if the login is successful, `setLoginStatus` will be called to set the login status accordingly, and the user will then be able to start using the addressbook.

Step4. The user executes some other commands.

Step5. The user executes `logout` command, `setLoginStatus` will be called to set the login status accordingly, and the user will be directed back to the login page.

Step6. The user terminates the program, `storeAccounts` will be called to store all the account information in the HashMap to the local storage.

The following sequence diagram shows how the login/register/logout mechanism works:

image:https://raw.githubusercontent.com/liguanlong/addressbook-level3/W7/docs/images/Login_Register_Logout_sequence.png[width=800,height=]

The following activity diagram explains the behaviour of the system during the execution of login/register/logout command.

image:https://raw.githubusercontent.com/liguanlong/addressbook-level3/W7/docs/images/Login_Register_Logout_activity.png[width=800,height=]

==== Design Considerations

===== Aspect: Data structure to keep account information during runtime

* **Alternative 1 (current choice):** Use a HashMap to keep the username password pairs.
** Pros: Higher performance, O(1) for most of the operations.
** Cons: Larger memory overhead.
* ** Alternative 2:** Use a TreeMap to keep the username password pairs. 
** Pros: Lower performance, O(log(n)) for most of the operations.
** Cons: Less memory overhead.

HashMap is used because memory is not a serious issue for this program as the program is not memory consuming in nature.
  
===== Aspect: File format to keep account information in local storage

* **Alternative 1:** Use a JSON file to store the username password pairs .
** Pros: More compatible with HashMap and have a smaller size compared with XML.
** Cons: Larger file size compared with CSV.
* ** Alternative 2:** Use a CSV file to store the username password pairs.
** Pros: Smallest in file size.
** Cons: complicated to convert to/from HashMap. 
* ** Alternative 2:** Use a XML file to store the username password pairs
** Pros: More compatible with HashMap. 
** Cons: Largest in file size.


[appendix]
== Non Functional Requirements

. Should work on any <<mainstream-os, mainstream OS>> as long as it has Java 9 or higher installed.
. Should be able to hold up to 1000 persons.
. Should come with automated unit tests and open source code.
. Should favor DOS style commands over Unix-style commands.

[appendix]
== Glossary

[[mainstream-os]] Mainstream OS::
Windows, Linux, Unix, OS-X

[[private-contact-detail]] Private contact detail::
A contact detail that is not meant to be shared with others.
